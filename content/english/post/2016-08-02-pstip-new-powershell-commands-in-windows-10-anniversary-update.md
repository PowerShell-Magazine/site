---
title: '#PSTip New PowerShell Commands in Windows 10 Anniversary Update'
author: Jan Egil Ring
type: post
date: 2016-08-02T16:00:03+00:00
url: /2016/08/02/pstip-new-powershell-commands-in-windows-10-anniversary-update/
views:
  - 26043
post_views_count:
  - 7798
categories:
  - Tips and Tricks
tags:
  - Tips and Tricks

---
Windows 10 Anniversary Update was made generally available on August 2, 2016.

Included in the update is a new version of Windows Management Framework, which has now reached version 5.1. By using the Get-PSVersion function in the PSVersion module I [released][1] earlier this year, we can determine that the build number is now 5.1.14393.0:

![](/images/win101.png)

By using Get-PSVersion -ListVersion we can also see the full history of PowerShell 5.* RTM versions for comparison:

![](/images/win102.png)

What might be even more interesting is to check out what commands are new between 5.1.14393.0 and the previous RTM build (5.0.10586.494). To make this process more convenient we can leverage another module I released this year, the PSVersionCompare module. Details on how to install it and perform a comparison between two PowerShell versions is available in [&#8220;Comparing Commands Between PowerShell Versions&#8221; article][2].

Since the initial release, I have also added functions to compare automatic variables as well. This is the commands I ran to compare the XML files from computer A running version 5.0.10586.494 and computer B running version 5.1.14393.0:

```powershell
Install-Module -Name PSVersionCompare
Import-Module -Name PSVersionCompare

$PSDataPath = "~\Documents"
$OutputPath = "~\Documents"
$SourceVersion = 'Microsoft Windows 10 Enterprise_5.0.10586.494_Desktop'
$CompareVersion = 'Microsoft Windows 10 Enterprise_5.1.14393.0_Desktop'

$Computers = @('ComputerA','ComputerB')

foreach ($Computer in $Computers) {

Get-PSVersionCommand -ComputerName $Computer -Export -Verbose
Get-PSVersionVariable -ComputerName $Computer -Export -Verbose

}

Compare-PSVersionCommand -SourceVersionPath (Join-Path -Path $PSDataPath -ChildPath ($SourceVersion + '_Commands.xml')) -CompareVersionPath (Join-Path -Path $PSDataPath -ChildPath ($CompareVersion + '_Commands.xml')) 6&gt;&1  | Out-File -FilePath (Join-Path -Path $OutputPath -ChildPath ($SourceVersion + '_' + $CompareVersion + '_Commands.txt'))

Compare-PSVersionVariable -SourceVersionPath (Join-Path -Path $PSDataPath -ChildPath ($SourceVersion + '_Variables.xml')) -CompareVersionPath (Join-Path -Path $PSDataPath -ChildPath ($CompareVersion + '_Variables.xml')) 6&gt;&1  | Out-File -FilePath (Join-Path -Path $OutputPath -ChildPath ($SourceVersion + '_' + $CompareVersion + '_Variables.txt'))
```

There is a lot of changes, which you can review in the following files generated by the above commands:

  * [Microsoft Windows 10 Enterprise\_5.0.10586.494\_Desktop\_Microsoft Windows 10 Enterprise\_5.1.14393.0\_Desktop\_Commands.txt][3]
  * [Microsoft Windows 10 Enterprise\_5.0.10586.494\_Desktop\_Microsoft Windows 10 Enterprise\_5.1.14393.0\_Desktop\_Variables.txt][4]

Some highlights to notice:

  * Four new modules: AppvClient, Microsoft.PowerShell.LocalAccounts, Microsoft.PowerShell.Operation.Validation and UEV
  * Three new cmdlets in module Microsoft.PowerShell.Management: Get-ComputerInfo, Get-TimeZone, and Set-TimeZone
  * Test-Connection has new parameters to support both DCOM and WSMan protocols.
  * Test-NetConnection has new parameters for constraining to an Interface or Source address.
  * The PackageManagement and PowerShellGet modules have new parameters for proxy support.
  * PSReadLine now has ViMode support.
  * A large number of changes in the Storage module.
  * A new automatic variable: PSEdition. The purpose of this variable is to make it possible to distinguish between Desktop edition (&#8220;regular&#8221; PowerShell based on the full .NET Framework) and Core edition (used on Nano Server, based on .NET Core). A couple of other side notes on this topic: PSEdition is also a new property in the $PSVersionTable automatic variable, and Update-ModuleManifest now has a CompatiblePSEditions parameter in order to specify which PowerShell Edition a module supports.

Of course there are many other enhancements in Windows Management Framework 5.1 which we did not discover by using the PSVersionCompare module. Be sure to check out the [WMF 5.1 Release][5] notes to find out more.

[1]: http://www.powershellmagazine.com/2016/03/10/decoding-powershell-build-numbers/
[2]: http://www.powershellmagazine.com/2016/04/29/comparing-commands-between-powershell-versions/
[3]: https://raw.githubusercontent.com/janegilring/PSVersionCompare/master/Output/txt/Microsoft%20Windows%2010%20Enterprise_5.0.10586.494_Desktop_Microsoft%20Windows%2010%20Enterprise_5.1.14393.0_Desktop_Commands.txt
[4]: https://raw.githubusercontent.com/janegilring/PSVersionCompare/master/Output/txt/Microsoft%20Windows%2010%20Enterprise_5.0.10586.494_Desktop_Microsoft%20Windows%2010%20Enterprise_5.1.14393.0_Desktop_Variables.txt
[5]: https://msdn.microsoft.com/en-us/powershell/wmf/5.1/release-notes